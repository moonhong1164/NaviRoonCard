<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NABY Rune Oracle Card</title>

<style>
:root{
  scroll-behavior:auto;
  --bg:#0b0f14; --panel:#121823; --panel-2:#0e141e;
  --text:#e8eef6; --muted:#9bb0c9; --ring:#2b3a52; --chip:#1a2332;
  --accent:#7cc4ff; --accent-2:#77f2c6;
  --shadow:0 10px 30px rgba(0,0,0,.45);
}
*{box-sizing:border-box}
body{
  margin:0;
  background:linear-gradient(180deg,#0a0f16,#0b1016 35%,#0f141d);
  color:var(--text);
  font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,
  "Noto Sans KR","Malgun Gothic",sans-serif;
}
.hidden{display:none!important}

header{
  position:sticky;top:0;z-index:20;
  backdrop-filter:blur(10px);
  background:rgba(10,15,22,.75);
  border-bottom:1px solid var(--ring);
}
.container{max-width:1100px;margin:0 auto;padding:16px}
.brand{display:flex;align-items:center;gap:10px}
.brand h1{margin:0;font-size:20px}

input[type="search"],select{
  width:100%;padding:12px;border-radius:12px;
  background:var(--panel);border:1px solid var(--ring);color:var(--text)
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(300px,1fr));
  gap:14px;padding:16px;
  background:linear-gradient(180deg,#0d1422,#0b111c);
  border:1px solid var(--ring);border-radius:14px
}

.card{
  background:radial-gradient(120% 120% at 80% 0%,rgba(124,196,255,.08),rgba(119,242,198,.06) 40%,rgba(10,14,20,0) 65%),var(--panel);
  border:1px solid var(--ring);border-radius:16px;padding:16px;
  box-shadow:var(--shadow);
}
.card-mini{
  background:radial-gradient(120% 120% at 80% 0%,rgba(124,196,255,.22),rgba(119,242,198,.16) 45%,rgba(10,14,20,0) 68%),linear-gradient(180deg,#161f31,#121a2a);
  border:1px solid rgba(124,196,255,.42);
  border-radius:14px;padding:14px;
  box-shadow:0 10px 24px rgba(0,0,0,.55),0 0 0 1px rgba(124,196,255,.12) inset;
}

.btn{
  display:inline-flex;align-items:center;gap:6px;
  background:linear-gradient(180deg,#1a2740,#152036);
  border:1px solid var(--ring);color:var(--text);
  padding:8px 12px;border-radius:12px;
  text-decoration:none;cursor:pointer
}

.drawbox{
  position:relative;margin:32px 0 22px;padding:16px;
  border-radius:18px;
  background:linear-gradient(180deg,#141b2a,#101725);
  border:1px solid rgba(124,196,255,.55);
  box-shadow:0 14px 34px rgba(0,0,0,.55),
             0 0 0 1px rgba(124,196,255,.18) inset;
}
.drawbox::after{
  content:"";position:absolute;left:12px;right:12px;top:8px;height:3px;
  border-radius:3px;
  background:linear-gradient(90deg,rgba(124,196,255,.8),rgba(119,242,198,.5));
}

.draw-actions{display:flex;flex-wrap:wrap;gap:10px;align-items:center}

.question-box{
  margin:10px 0 0;padding:12px;border-radius:12px;
  background:linear-gradient(180deg,#0e1523,#0c1220);
  border:1px solid rgba(124,196,255,.35);
  color:#bcd0ea
}

.draw-result{
  display:grid;
  grid-template-columns:repeat(1,minmax(0,1fr));
  gap:12px;margin-top:12px
}
.draw-result.triple{
  grid-template-columns:repeat(3,minmax(0,1fr))!important;
}

.section-sep{
  height:14px;margin:26px 0 12px;
  background:radial-gradient(60% 10px at 50% 100%,rgba(124,196,255,.45),rgba(119,242,198,0));
}
.section-title{
  margin:0 0 10px;font-size:14px;color:var(--muted);
  display:flex;align-items:center;gap:8px
}
.section-title::before{
  content:"";width:9px;height:9px;border-radius:50%;
  background:linear-gradient(180deg,#8dd0ff,#77f2c6);
}
.footer{text-align:center;color:var(--muted);padding:40px;border-top:1px solid var(--ring)}
</style>
</head>

<body>
<header>
  <div class="container">
    <div class="brand">
      <h1>NABY RUNE ORACLE CARD</h1>
    </div>
  </div>
</header>

<main class="container">

  <!-- 뽑기 영역 -->
  <section class="drawbox">
    <div class="draw-actions">
      <label><input id="toggleQuestion" type="checkbox"> 질문 입력 칸 표시</label>
      <input id="questionInput" type="search" class="hidden" placeholder="질문을 적어 주세요 (선택)">
      <button id="btnDraw1" class="btn">🃏 1카드 뽑기</button>
      <button id="btnDraw3" class="btn">🃏🃏🃏 3카드 뽑기</button>
    </div>

    <div id="questionBox" class="question-box hidden"></div>
    <div id="drawResult" class="draw-result"></div>
  </section>

  <div class="section-sep"></div>
  <h2 class="section-title">전체 카드 목록</h2>

  <input id="q" type="search" placeholder="룬 이름 / 키워드 검색">
  <select id="sort">
    <option value="name">이름순</option>
    <option value="korean">한글순</option>
  </select>

  <div id="grid" class="grid"></div>
  <div id="empty" class="hidden" style="padding:16px;text-align:center;color:var(--muted)">검색 결과가 없습니다.</div>

</main>

<footer class="footer">
  자료 출처: NABY RUNE ORACLE CARD<br>
  제작: 나비🦋, 월홍🌙
</footer>

<script>
const RUNES=[
 /* ... (생략 없이 전체 RUNES 그대로 넣으면 됩니다. 기존 리스트 그대로) ... */
];

const grid=document.getElementById('grid');
const empty=document.getElementById('empty');
const q=document.getElementById('q');
const sort=document.getElementById('sort');

const btnDraw1=document.getElementById('btnDraw1');
const btnDraw3=document.getElementById('btnDraw3');
const drawResult=document.getElementById('drawResult');
const toggleQuestion=document.getElementById('toggleQuestion');
const questionInput=document.getElementById('questionInput');
const questionBox=document.getElementById('questionBox');

// ✅ 첫 로드시 질문 입력칸 숨김 유지
toggleQuestion.checked=false;
questionInput.classList.add('hidden');

// 전체 목록 렌더
function render(list){
  grid.innerHTML='';
  if(!list.length){ empty.classList.remove('hidden'); return; }
  empty.classList.add('hidden');

  list.forEach(r=>{
    const el=document.createElement('article');
    el.className='card';
    el.innerHTML=`
      <div class="chip">${r.code}</div>
      <h3 style="margin:6px 0">${r.name}</h3>
      <p><strong>정방향</strong> — ${r.up}</p>
      <p><strong>역방향</strong> — ${(r.rv && r.rv.trim()!=='—')?r.rv:r.up}</p>
    `;
    grid.appendChild(el);
  });
}

function searchAndSort(){
  const term=q.value.trim().toLowerCase();
  let list=RUNES.filter(r=>
       r.name.toLowerCase().includes(term)
    || r.kr.toLowerCase().includes(term)
    || r.code.toLowerCase().includes(term)
    || r.up.toLowerCase().includes(term)
    || (r.rv && r.rv.toLowerCase().includes(term))
  );
  if(sort.value==='name') list.sort((a,b)=>a.code.localeCompare(b.code));
  if(sort.value==='korean') list.sort((a,b)=>a.kr.localeCompare(b.kr,'ko'));
  render(list);
}

q.addEventListener('input',searchAndSort);
sort.addEventListener('change',searchAndSort);
searchAndSort();

// 랜덤 뽑기
function randomRune(){
  const r=RUNES[Math.floor(Math.random()*RUNES.length)];
  const reversed=Math.random()<0.5;
  return {...r, reversed};
}

function miniCard(r){
  const orientation=r.reversed?'역방향':'정방향';
  const mean=r.reversed?((r.rv&&r.rv.trim()!=='—')?r.rv:r.up):r.up;
  return `
  <article class="card-mini">
    <div style="font-size:13px;margin-bottom:4px">
      <span class="chip">${r.code}</span>
      <span class="chip">${r.kr}</span>
      <span class="chip">${orientation}</span>
    </div>
    <h4 style="margin:6px 0 4px">${r.name}</h4>
    <p>${mean}</p>
  </article>`;
}

function draw(n){
  const picked=Array.from({length:n},()=>randomRune());

  if(toggleQuestion.checked && questionInput.value.trim()){
    questionBox.classList.remove('hidden');
    questionBox.textContent=`질문: ${questionInput.value.trim()}`;
  }else{
    questionBox.classList.add('hidden');
    questionBox.textContent='';
  }

  drawResult.classList.toggle('triple',n===3);
  drawResult.innerHTML=picked.map(miniCard).join('');
}

btnDraw1.addEventListener('click',()=>draw(1));
btnDraw3.addEventListener('click',()=>draw(3));

toggleQuestion.addEventListener('change',()=>{
  if(toggleQuestion.checked){
    questionInput.classList.remove('hidden');
    questionInput.focus();
  }else{
    questionInput.classList.add('hidden');
    questionInput.value='';
  }
});
</script>
</body>
</html>
